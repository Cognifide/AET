/*
 * This file was generated by the Gradle 'init' task.
 */

plugins {
    id 'com.cognifide.aet.java-conventions'
}

task copyFeaturesXmlFile(type: Copy) {
    includeEmptyDirs = false
    from("${rootDir}/osgi-dependencies") {
        include "**/aet-features.xml"
        include "**/aet-webconsole.xml"
    }
    into "${buildDir}"
}

task zipConfigs(type: Zip) {
    archiveFileName = "${project.group}.configs.zip"
    destinationDirectory = file("$buildDir/packages")
    from "${rootDir}/osgi-dependencies/configs/src/main/resources"
}

task copyArtifacts {
    dependsOn rootProject.getTasksByName('build', true)
    doLast {
        delete "${buildDir}/jars"
        copy {
            includeEmptyDirs = false
            rootProject.subprojects { subproject ->
                from("${subproject.buildDir}/libs") {
                    include "**/${subproject.name}*.jar"
                    exclude "*aet-maven-plugin*.jar"
                    exclude "*-test*.jar"
                    exclude "*client*.jar"
                    exclude "*zip*"
                    rename { "${project.group}.${subproject.name}.jar" }
                }
            }
            into "${buildDir}/packages"
        }
    }
}

description = 'AET'
